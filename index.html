<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Hotel Vista Inn â€“ Ranthambore</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
<link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
  />  
<link rel="stylesheet" href="style.css">
</head>


<body>
  <header>
    <div class="brand">
  <img src="images/logo.png" alt="Hotel Vista Inn Logo" class="logo-img">
  <h1 class="hotel-name">Hotel Vista Inn</h1>
</div>
    <p>Ranthambore, Sawai Madhopur</p>
    <nav>
      <a href="#">Home</a>
      <a href="#rooms">Rooms</a>
      <a href="offers.html">Offers</a>
      <a href="#contact">Contact</a>
    </nav>
  </header>

  <main>
    <section class="hero">
  <div class="slideshow">
    <img src="images/room1.avif" alt="Room 1">
    <img src="images/room2.avif" alt="Room 2">
    <img src="images/tiger1.jpg" alt="Lobby">
    <img src="images/tiger2.jpg" alt="Suite">
  </div>
  <div class="overlay-text">
    <h2>Welcome to Vista Inn</h2>
    <p>Your comfortable stay near Ranthambore National Park.</p>
  </div>
</section>

<section class="availability">
  <h2>Check Room Availability</h2>
  <form id="search-form" class="search-form">
  <label>
    Check-in:
    <input type="date" name="checkin" required min="">
  </label>
  <label>
    Check-out:
    <input type="date" name="checkout" required min="">
  </label>
  <label>
    Guests:
    <input type="number" name="guests" min="1" max="2" required>
  </label>
  <label>
    Room Type:
    <select name="roomtype" required>
      <option value="double">Deluxe Double Room</option>
      <option value="single">Deluxe Single Room</option>
    </select>
  </label>
  <button type="submit">Check Availability</button>
</form>
<div id="availability-result"></div>

</section>
<section class="experience">
  <h2>Experience the Wild & Comfort</h2>
  <p>
    Nestled near the edge of the majestic <strong>Ranthambhore National Park</strong>, Vista Inn offers you the perfect balance of comfort and adventure.
    Whether you're here for a thrilling wildlife safari or a peaceful getaway, our inn is the ideal base to explore nature at its best.
  </p>
  <h3>What Our Guests Can Expect:</h3>
  <ul>
    <li>ğŸ›ï¸ Comfortable, air-conditioned rooms with modern amenities</li>
    <li>ğŸ… Guided safaris to spot tigers, leopards, and exotic birds</li>
    <li>ğŸŒ„ Scenic views and peaceful surroundings</li>
    <li>ğŸ² Delicious Rajasthani and Indian cuisine</li>
    <li>ğŸ”¥ Night bonfires and storytelling under the stars</li>
  </ul>

  <h3>About Ranthambhore National Park:</h3>
  <p>
    One of Indiaâ€™s most famous tiger reserves, Ranthambhore is a haven for nature lovers and wildlife photographers.
    Experience the thrill of spotting Bengal tigers in the wild, along with sloth bears, hyenas, and a rich variety of birdlife.
    Open from October to June, the park offers a truly unforgettable journey into the wild.
  </p>
</section>

    <section id="rooms" class="rooms">
      <h2>Our Rooms</h2>
      <div class="room">
  <h3><a href="double-room.html">Deluxe Double Room (x3)</a></h3>
  <p>Spacious rooms with double beds, AC, free Wi-Fi, and breakfast.</p>
</div>

<div class="room">
  <h3><a href="single-room.html">Deluxe Single Room (x1)</a></h3>
  <p>Perfect for solo travelers with all amenities.</p>
</div>

    </section>

    <section id="contact" class="contact">
      <h2>Contact Us</h2>
      <p>ğŸ“ Location: Vista Inn, Ranthambore, Sawai Madhopur</p>
      <p>ğŸ“ Phone: +91-XXXXXXXXXX</p>
      <p>ğŸ“§ Email: info@vistainn.com</p>
    </section>
  </main>

  <footer>
    <p>Â© 2025 Vista Inn. All rights reserved.</p>
  </footer>

  <script>
    // Simple slideshow
    const slides = document.querySelectorAll(".slideshow img");
    let index = 0;
    setInterval(() => {
      slides.forEach((img, i) => {
        img.style.opacity = (i === index) ? "1" : "0";
      });
      index = (index + 1) % slides.length;
    }, 4000);
  </script>
  
<a
  href="https://wa.me/919982077024?text=Hello%20I%20want%20to%20know%20about%20booking"
  class="whatsapp-float"
  target="_blank"
  rel="noopener noreferrer"
  aria-label="Chat on WhatsApp"
>
  <i class="fab fa-whatsapp"></i>
</a>
<!-- âœ… Supabase SDK -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<script>
  const { createClient } = supabase;

  const supabaseClient = createClient(
    'https://fvfhptpkyntqijtpgdse.supabase.co',
    'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZ2ZmhwdHBreW50cWlqdHBnZHNlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTEzNDk4OTAsImV4cCI6MjA2NjkyNTg5MH0.HFVj4oZ_acMOmLiL7ix-G8DahuWzmL9mqDkuvjr8HRA'
  );

  function getDateRange(start, end) {
    const dates = [];
    let curr = new Date(start);
    const last = new Date(end);
    last.setDate(last.getDate() - 1);
    while (curr <= last) {
      dates.push(curr.toISOString().split("T")[0]);
      curr.setDate(curr.getDate() + 1);
    }
    return dates;
  }

  window.addEventListener("DOMContentLoaded", function () {
    const form = document.getElementById("search-form");
    if (!form) return;

    form.addEventListener("submit", async (e) => {
      e.preventDefault();

      const room_type = form.elements["roomtype"].value;
      const checkin = form.elements["checkin"].value;
      const checkout = form.elements["checkout"].value;
      const guests = form.elements["guests"].value;

      const dateRange = getDateRange(checkin, checkout);
      const maxRooms = room_type === "double" ? 3 : 1;
      const today = new Date().toISOString().split("T")[0];
      document.querySelector('input[name="checkin"]').min = today;
      document.querySelector('input[name="checkout"]').min = today;
      let totalPrice = 0;
      let available = true;

      for (const date of dateRange) {
        const { data: bookings = [] } = await supabaseClient
          .from("bookings")
          .select("*")
          .eq("room_type", room_type)
          .or(`and(checkin_date.lte.${date},checkout_date.gte.${date})`);

        const { data: blocked = [] } = await supabaseClient
          .from("blocked_dates")
          .select("*")
          .eq("room_type", room_type)
          .lte("start_date", date)
          .gte("end_date", date);

        const totalBooked = bookings.length + blocked.length;

        if (totalBooked >= maxRooms) {
          available = false;
          break;
        }

        const { data: priceData = [] } = await supabaseClient
          .from("room_prices")
          .select("price")
          .eq("room_type", room_type)
          .eq("date", date);

        totalPrice += priceData.length > 0
          ? parseFloat(priceData[0].price)
          : (room_type === "double" ? 2000 : 1200);
      }

      const resultDiv = document.getElementById("availability-result");

      if (!available) {
        resultDiv.innerHTML = `<p style="color: red;">âŒ No rooms available for selected dates.</p>`;
        return;
      }

      // âœ… Show availability and link to booking page
      resultDiv.innerHTML = `
        <div style="color: green;">
          âœ… Room available for selected dates!<br>
          ğŸ’° Total for ${dateRange.length} night(s): â‚¹${totalPrice}<br><br>
          <a href="booking.html?checkin=${checkin}&checkout=${checkout}&guests=${guests}&roomtype=${room_type}&price=${totalPrice}" class="book-now-link">ğŸ‘‰ Book Now</a>
        </div>
      `;
    });
  });
</script>
</body>
</html>
