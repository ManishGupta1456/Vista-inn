<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Hotel Vista Inn – Ranthambore</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
</head>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
  const SUPABASE_URL = "https://fvfhptpkyntqijtpgdse.supabase.co";
  const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZ2ZmhwdHBreW50cWlqdHBnZHNlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTEzNDk4OTAsImV4cCI6MjA2NjkyNTg5MH0.HFVj4oZ_acMOmLiL7ix-G8DahuWzmL9mqDkuvjr8HRA";

  const supabase = createClient(SUPABASE_URL, SUPABASE_KEY);

  async function checkAvailability(checkin, checkout, room_type) {
    const { data, error } = await supabase
      .from('bookings')
      .select('*')
      .or(`and(checkin_date.lte.${checkout},checkout_date.gte.${checkin})`)
      .eq('room_type', room_type);

    if (error) {
      alert("Error checking availability");
      return;
    }

    if (data.length > 0) {
      alert("❌ No rooms available for selected dates.");
    } else {
      window.location.href = "booking.html";
    }
  }

  // Bind your search form
  document.querySelector("#search-form").addEventListener("submit", function(e) {
    e.preventDefault();
    const checkin = document.querySelector("[name=checkin]").value;
    const checkout = document.querySelector("[name=checkout]").value;
    const guests = document.querySelector("[name=guests]").value;

    checkAvailability(checkin, checkout, "double"); // or "single"
  });
</script>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
  const supabase = createClient('YOUR_SUPABASE_URL', 'YOUR_SUPABASE_KEY');

  document.querySelector('form').addEventListener('submit', async (e) => {
    e.preventDefault();

    const room_type = e.target.roomtype.value;
    const checkin = e.target.checkin.value;
    const checkout = e.target.checkout.value;

    // Check existing bookings count
    const { data: bookings, error: bookingError } = await supabase
      .from('bookings')
      .select('*')
      .or(`and(checkin_date.lte.${checkout},checkout_date.gte.${checkin})`)
      .eq('room_type', room_type);

    const { data: blocked, error: blockError } = await supabase
      .from('blocked_dates')
      .select('*')
      .eq('room_type', room_type)
      .eq('blocked_date', checkin);

    const maxRooms = room_type === 'double' ? 3 : 1;

    if ((bookings.length + blocked.length) >= maxRooms) {
      alert("❌ No rooms available for the selected date.");
      return;
    }

    // Proceed with booking
    const { error: saveError } = await supabase.from('bookings').insert([{
      room_type,
      checkin_date: checkin,
      checkout_date: checkout,
      guest_name: e.target.name.value,
      guest_email: e.target.email.value
    }]);

    if (saveError) {
      alert("❌ Booking failed.");
    } else {
      alert("✅ Booking confirmed!");
      window.location.href = "index.html";
    }
  });
</script>

<body>
  <header>
    <div class="brand">
  <img src="images/logo.png" alt="Hotel Vista Inn Logo" class="logo-img">
  <h1 class="hotel-name">Hotel Vista Inn</h1>
</div>
    <p>Ranthambore, Sawai Madhopur</p>
    <nav>
      <a href="#">Home</a>
      <a href="#rooms">Rooms</a>
      <a href="offers.html">Offers</a>
      <a href="#contact">Contact</a>
    </nav>
  </header>

  <main>
    <section class="hero">
  <div class="slideshow">
    <img src="images/room1.avif" alt="Room 1">
    <img src="images/room2.avif" alt="Room 2">
    <img src="images/tiger1.jpg" alt="Lobby">
    <img src="images/tiger2.jpg" alt="Suite">
  </div>
  <div class="overlay-text">
    <h2>Welcome to Vista Inn</h2>
    <p>Your comfortable stay near Ranthambore National Park.</p>
  </div>
</section>

<section class="availability">
  <h2>Check Room Availability</h2>
  <form action="booking.html" method="GET" class="search-form">
    <label>
      Check-in:
      <input type="date" name="checkin" required>
    </label>
    <label>
      Check-out:
      <input type="date" name="checkout" required>
    </label>
    <label>
      Guests:
      <input type="number" name="guests" min="1" max="10" required>
    </label>
    <button type="submit">Check Availability</button>
  </form>
</section>
<section class="experience">
  <h2>Experience the Wild & Comfort</h2>
  <p>
    Nestled near the edge of the majestic <strong>Ranthambhore National Park</strong>, Vista Inn offers you the perfect balance of comfort and adventure.
    Whether you're here for a thrilling wildlife safari or a peaceful getaway, our inn is the ideal base to explore nature at its best.
  </p>
  <h3>What Our Guests Can Expect:</h3>
  <ul>
    <li>🛏️ Comfortable, air-conditioned rooms with modern amenities</li>
    <li>🐅 Guided safaris to spot tigers, leopards, and exotic birds</li>
    <li>🌄 Scenic views and peaceful surroundings</li>
    <li>🍲 Delicious Rajasthani and Indian cuisine</li>
    <li>🔥 Night bonfires and storytelling under the stars</li>
  </ul>

  <h3>About Ranthambhore National Park:</h3>
  <p>
    One of India’s most famous tiger reserves, Ranthambhore is a haven for nature lovers and wildlife photographers.
    Experience the thrill of spotting Bengal tigers in the wild, along with sloth bears, hyenas, and a rich variety of birdlife.
    Open from October to June, the park offers a truly unforgettable journey into the wild.
  </p>
</section>

    <section id="rooms" class="rooms">
      <h2>Our Rooms</h2>
      <div class="room">
  <h3><a href="double-room.html">Deluxe Double Room (x3)</a></h3>
  <p>Spacious rooms with double beds, AC, free Wi-Fi, and breakfast.</p>
</div>

<div class="room">
  <h3><a href="single-room.html">Deluxe Single Room (x1)</a></h3>
  <p>Perfect for solo travelers with all amenities.</p>
</div>

    </section>

    <section id="contact" class="contact">
      <h2>Contact Us</h2>
      <p>📍 Location: Vista Inn, Ranthambore, Sawai Madhopur</p>
      <p>📞 Phone: +91-XXXXXXXXXX</p>
      <p>📧 Email: info@vistainn.com</p>
    </section>
  </main>

  <footer>
    <p>© 2025 Vista Inn. All rights reserved.</p>
  </footer>

  <script>
    // Simple slideshow
    const slides = document.querySelectorAll(".slideshow img");
    let index = 0;
    setInterval(() => {
      slides.forEach((img, i) => {
        img.style.opacity = (i === index) ? "1" : "0";
      });
      index = (index + 1) % slides.length;
    }, 4000);
  </script>
<script>
  const slides = document.querySelectorAll(".slideshow img");
  let index = 0;
  setInterval(() => {
    slides.forEach((img, i) => {
      img.style.opacity = (i === index) ? "1" : "0";
    });
    index = (index + 1) % slides.length;
  }, 4000);
</script>
</body>
</html>
